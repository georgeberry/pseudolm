% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pseudo_lm.R
\name{pseudo_lm}
\alias{pseudo_lm}
\title{Linear Model With Identity-Matrix Pseudo-Observations}
\usage{
pseudo_lm(
  formula,
  data,
  subset,
  weights,
  na.action,
  method = "qr",
  model = TRUE,
  x = FALSE,
  y = FALSE,
  qr = TRUE,
  singular.ok = TRUE,
  contrasts = NULL,
  offset,
  ...
)
}
\arguments{
\item{formula}{A formula specifying the model to be fitted.}

\item{data}{An optional data frame, list, or environment containing the
variables in the model. See \code{\link[stats:lm]{stats::lm()}}.}

\item{subset}{Optional expression specifying a subset of observations.}

\item{weights}{Optional numeric vector of weights for weighted least squares.}

\item{na.action}{Function that indicates what should happen when \code{NA}s are
encountered. See \code{\link[stats:lm]{stats::lm()}}.}

\item{method}{Method to be used; only \code{"qr"} is supported, as in \code{lm()}.}

\item{model}{Logical; if \code{TRUE}, include the model frame in the returned object.}

\item{x}{Logical; if \code{TRUE}, return the model matrix.}

\item{y}{Logical; if \code{TRUE}, return the response vector.}

\item{qr}{Logical; if \code{TRUE}, return the QR decomposition.}

\item{singular.ok}{Logical; if \code{FALSE}, a singular fit causes an error.}

\item{contrasts}{Optional list specifying contrasts for factor variables.}

\item{offset}{Optional offset to be included in the model.}

\item{...}{Additional arguments passed through to \code{\link[stats:model.frame]{stats::model.frame()}},
\code{\link[stats:lmfit]{stats::lm.fit()}}, or \code{\link[stats:lmfit]{stats::lm.wfit()}}.}
}
\value{
An object of class \code{"lm"}, identical in structure to the output of
\code{\link[stats:lm]{stats::lm()}}, but fitted on an augmented system including the pseudo-
observations.
}
\description{
\code{pseudo_lm()} behaves exactly like \code{\link[stats:lm]{stats::lm()}} but augments the regression
system with \eqn{p} pseudo-observations, where \eqn{p} is the number of
columns in the model matrix \eqn{X}. Specifically, the model is fit to an
augmented system:
}
\details{
\deqn{
  \tilde{X} = \begin{bmatrix} X \\ I_p \end{bmatrix}, \quad
  \tilde{y} = \begin{bmatrix} y \\ \mathbf{1}_p \end{bmatrix}
}

This is equivalent to adding one pseudo-observation for each coefficient,
using the identity matrix as the design rows and a vector of ones as the
pseudo-response. The effect is a simple regularization that shrinks
coefficients toward 1 (or toward 0 if the function is modified accordingly).

All other behavior—including handling of formulas, contrasts, weights,
NA processing, and returned object structure—matches \code{lm()} exactly.
}
\seealso{
\code{\link[stats:lm]{stats::lm()}}, \code{\link[stats:lmfit]{stats::lm.fit()}}
}
